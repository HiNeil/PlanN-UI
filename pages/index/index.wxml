<view class="page">
  <view wx:if="{{!userInfoAuthorized}}">
    <view wx:if="{{canIUse}}">
      <view class='header'>
        <image src='/style/images/un_login.jpeg'></image>
      </view>
      <view class='content'>
        <view>申请获取以下权限</view>
        <text>获得你的公开信息(昵称，头像等)</text>
      </view>
      <button class='bottom' type='primary' open-type="getUserInfo" lang="zh_CN" bindgetuserinfo="clickGetUserInfo">
        授权登录
      </button>
    </view>
    <view wx:else>请升级微信版本</view>
  </view>
  <view wx:elif="{{!userInfo && !userId}}">
    <view class="page__bd">
      <view class="weui-loadmore">
        <view class="weui-loading"></view>
        <view class="weui-loadmore__tips">加载中...</view>
      </view>
    </view>
  </view>
  <view wx:else>
    <view class="page__hd">
      <view>
        <view class="page__title" bindtap="getSystemInfo" bind>
          <text style="color:orange">Plan N</text>
        </view>
        <view wx:if="{{appliedPlan}}" class="page__desc">当前已激活计划:{{appliedPlan.planName}}</view>
        <view wx:else class="page__desc">当前未激活计划</view>
        <view class="page__desc">点击可将项目标记为今天已完成</view>
      </view>
    </view>
    <view class="page__bd page__bd_spacing">
      <view class="weui-cells weui-cells_after-title">
        <view wx:if="{{!appliedPlan}}">
          <view class="weui-cell weui-cell_access">
            <view class="weui-cell__bd">
              未激活计划
              <text class='dialog-close' decode='true'>&gt;</text> ﹏
              <text class='dialog-close' decode='true'>&lt;</text>
            </view>
            <view class="weui-cell__ft">
              点击去激活 →_→
            </view>
          </view>
        </view>
        <view wx:else>
          <view wx:if="{{!appliedPlanDeail}}">
            <view class="weui-cell weui-cell_access">
              <view class="weui-cell__bd">
                计划项为空
                <text class='dialog-close' decode='true'>&gt;</text> ﹏
                <text class='dialog-close' decode='true'>&lt;</text>
              </view>
              <view class="weui-cell__ft">
                点击去添加 →_→
              </view>
            </view>
          </view>
          <view wx:else>
            <block wx:for="{{appliedPlanDeail}}" wx:for-item="planItem" wx:key="number" wx:for-index="idx" ex:key="number">
              <view class="weui-cell weui-cell_access" bindtap="popConfirmFinished" data-idx="{{idx}}">
                <view class="weui-cell__bd">{{planItem.description}}</view>
                <icon wx:if="{{planItem.finished}}" class="weui-icon-radio" type="success_no_circle" size="16"></icon>
                <!-- <view class="weui-cell__ft">{{planItem.number}}</view> -->
              </view>
            </block>
          </view>
        </view>
      </view>
      <view class="button-sp-area">
        <button class="weui-btn" type="primary" plain="true" bindtap="getSystemInfo" bindlongtap="popRemind">踢一下
          <text style="color:orange">TA</text>
        </button>
        <button class="weui-btn" type="primary" size="mini">test</button>
      </view>
    </view>
  </view>
</view>